<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Authentication System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .form-container {
            display: none;
        }
        .form-container.active {
            display: block;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <div class="max-w-md mx-auto bg-white rounded-lg shadow-md overflow-hidden">
            <div class="flex">
                <button id="loginTab" class="w-1/2 py-4 text-center font-medium text-gray-600 bg-gray-200 hover:bg-gray-300 focus:outline-none">Login</button>
                <button id="signupTab" class="w-1/2 py-4 text-center font-medium text-gray-600 bg-gray-200 hover:bg-gray-300 focus:outline-none">Signup</button>
            </div>
            
            <!-- Login Form -->
            <div id="loginForm" class="form-container active p-6">
                <h2 class="text-2xl font-bold mb-6 text-center text-gray-800">Login</h2>
                <form id="loginFormSubmit">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="login-username">
                            Username
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="login-username" type="text" placeholder="Username" required>
                    </div>
                    <div class="mb-6">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="login-password">
                            Password
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" id="login-password" type="password" placeholder="******************" required>
                    </div>
                    <div class="flex items-center justify-between">
                        <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
                            Sign In
                        </button>
                        <a class="inline-block align-baseline font-bold text-sm text-blue-500 hover:text-blue-800" href="#">
                            Forgot Password?
                        </a>
                    </div>
                </form>
            </div>
            
            <!-- Signup Form -->
            <div id="signupForm" class="form-container p-6">
                <h2 class="text-2xl font-bold mb-6 text-center text-gray-800">Create an Account</h2>
                <form id="signupFormSubmit">
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="signup-username">
                            Username
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="signup-username" type="text" placeholder="Username" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="signup-email">
                            Email
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="signup-email" type="email" placeholder="Email" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="signup-password">
                            Password
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="signup-password" type="password" placeholder="******************" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="signup-phone">
                            Phone
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="signup-phone" type="tel" placeholder="Phone Number" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="signup-fullname">
                            Full Name
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="signup-fullname" type="text" placeholder="Full Name" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2">
                            Gender
                        </label>
                        <div class="flex space-x-4">
                            <label class="inline-flex items-center">
                                <input type="radio" class="form-radio" name="gender" value="male" required>
                                <span class="ml-2">Male</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" class="form-radio" name="gender" value="female">
                                <span class="ml-2">Female</span>
                            </label>
                            <label class="inline-flex items-center">
                                <input type="radio" class="form-radio" name="gender" value="other">
                                <span class="ml-2">Other</span>
                            </label>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="signup-dob">
                            Date of Birth
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="signup-dob" type="date" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="signup-city">
                            City
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="signup-city" type="text" placeholder="City" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="signup-state">
                            State
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="signup-state" type="text" placeholder="State" required>
                    </div>
                    <div class="mb-4">
                        <label class="block text-gray-700 text-sm font-bold mb-2" for="signup-country">
                            Country
                        </label>
                        <input class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="signup-country" type="text" placeholder="Country" required>
                    </div>
                    <div class="mb-6">
                        <label class="inline-flex items-center">
                            <input type="checkbox" class="form-checkbox" name="terms" required>
                            <span class="ml-2">I agree to the <a href="#" class="text-blue-500">Terms and Conditions</a></span>
                        </label>
                    </div>
                    <div class="flex items-center justify-between">
                        <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" type="submit">
                            Create Account
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = '<%= apiBase %>';
        document.addEventListener('DOMContentLoaded', function() {
            const loginTab = document.getElementById('loginTab');
            const signupTab = document.getElementById('signupTab');
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');

            // Tab switching
            loginTab.addEventListener('click', function() {
                loginForm.classList.add('active');
                signupForm.classList.remove('active');
                loginTab.classList.add('bg-white');
                loginTab.classList.remove('bg-gray-200');
                signupTab.classList.add('bg-gray-200');
                signupTab.classList.remove('bg-white');
            });

            signupTab.addEventListener('click', function() {
                signupForm.classList.add('active');
                loginForm.classList.remove('active');
                signupTab.classList.add('bg-white');
                signupTab.classList.remove('bg-gray-200');
                loginTab.classList.add('bg-gray-200');
                loginTab.classList.remove('bg-white');
            });

            // Form submissions
            document.getElementById('loginFormSubmit').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const username = document.getElementById('login-username').value;
                const password = document.getElementById('login-password').value;
                
                fetch(`${API_BASE}/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ username, password }),
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        window.location.href = '/dashboard';
                        alert('Login successful!');
                    } else {
                        alert('Login failed: ' + data.message);
                    }
                })
                .catch(error => {
                    alert('Error: ' + error.message);
                });
            });

            document.getElementById('signupFormSubmit').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const formData = {
                    username: document.getElementById('signup-username').value,
                    email: document.getElementById('signup-email').value,
                    password: document.getElementById('signup-password').value,
                    phone: document.getElementById('signup-phone').value,
                    fullname: document.getElementById('signup-fullname').value,
                    gender: document.querySelector('input[name="gender"]:checked').value,
                    dob: document.getElementById('signup-dob').value,
                    city: document.getElementById('signup-city').value,
                    state: document.getElementById('signup-state').value,
                    country: document.getElementById('signup-country').value,
                    terms: document.querySelector('input[name="terms"]').checked
                };
                
                fetch(`${API_BASE}/register`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData),
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('Account created successfully! Please log in.');
                        // Reset form and switch to login
                        document.getElementById('signupFormSubmit').reset();
                        loginTab.click();
                    } else {
                        alert('Signup failed: ' + data.message);
                    }
                })
                .catch(error => {
                    alert('Error: ' + error.message);
                });
            });
        });
    </script>
</body>
</html>